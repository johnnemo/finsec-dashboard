{
  "id": "../sdos/x-probe.json",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "x-probe",
  "description": "Identifies a probe.",
  "type": "object",
  "allOf": [
    {
      "$ref": "../../../stix2-schemas/schemas/common/core.json"
    },
    {
      "properties": {
        "type": {
          "type": "string",
          "description": "It MUST be the literal `x-probe`.",
          "enum": [
            "x-probe"
          ]
        },
        "id": {
          "title": "id",
          "pattern": "^x-probe--"
        },
        "name": {
          "type": "string",
          "description": "The name of the probe."
        },
        "description": {
          "type": "string",
          "description": "A description that provides more details and context about the probe."
        },
        "x_organization": {
          "type": "string",
          "description": "Reference to the organization which is owner of the information contained in the object.",
          "pattern": "^x-organization--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
        },
        "subtype": {
          "type": "string",
          "description": "The subtype of the probe. Subtype should be one of probe-subtype-ov."
        },
        "domain": {
          "type": "string",
          "description": "The domain of the probe. It can be Cyber, Physical or Logical.",
          "enum": [
            "Cyber",
            "Physical",
            "Logical"
          ]
        },
        "asset_refs": {
          "type": "array",
          "description": "Specifies the FINSTIX assets that are monitored by the probe.",
          "items": {
            "pattern": "^x-asset--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
          }
        },
        "event_refs": {
          "type": "array",
          "description": "Specifies the references to the events (of datatype model) that could be generated by the probe.",
          "items": {
            "pattern": "^x-event--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
          }
        },
        "ipv4_addr": {
          "type": "string",
          "description": "The IP version 4 address of the probe.",
          "pattern": "^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]).){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$"
        },
        "ipv6_addr": {
          "type": "string",
          "description": "The IP version 6 address of the Probe.",
          "pattern": "(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]).){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]).){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$"
        },
        "observable_url": {
          "type": "object",
          "description": "The url where the probe stores it's observed data",
          "$ref": "../../../stix2-schemas/schemas/observables/url.json"
        },
        "datatype": {
          "type": "string",
          "description": "Datatype can be Model or Instance. Model indicates that the object is a model that can be used as a basis for the analytics. Instance is used when the object is generated at run-time.",
          "enum": [
            "Model",
            "Instance"
          ]
        },
        "reference": {
          "type": "string",
          "description": "Reference to the asset corresponding to the probe.",
          "pattern": "^x-asset--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
        },
        "model_ref": {
          "type": "string",
          "description": "It is used by the probe with datatype instance to refer to the related model.",
          "pattern": "^x-[a-z0-9][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
        }
      }
    }
  ],
  "required": [
    "name",
    "description",
    "domain",
    "subtype",
    "x_organization",
    "datatype",
    "reference",
    "model_ref",
    "asset_refs",
    "event_refs",
    "observable_url"
  ],
  "definitions": {
    "probe-subtype-ov": {
      "type": "string",
      "enum": [
        "LOG",
        "CCTV",
        "SIEM",
        "PSIA",
        "Camera"
      ]
    }
  }
}
