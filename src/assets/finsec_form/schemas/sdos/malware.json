{
  "id": "../sdos/malware.json",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "malware",
  "description": "A malware is a type of TTP, also known as malicious code and malicious software, used to compromise the confidentiality, integrity, or availability of a victimâ€™s data or system. ",
  "type": "object",
  "allOf": [
    {
      "$ref": "../../../../schemas/stix2-schemas/schemas/common/core.json"
    },
    {
      "properties": {
        "id": {
          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
          "type": "string",
          "pattern": "^[a-z0-9][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
        },
        "type": {
          "type": "string",
          "description": "It MUST be the literal `x-asset`.",
          "enum": [
            "malware"
          ]
        },
        "labels": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "minItems": 1
        },
        "name": {
          "type": "string",
          "description": "The name used to identify the Malware."
        },
        "description": {
          "type": "string",
          "description": "Provides more context and details about the Malware object."
        },
        "product_name": {
          "type": "string",
          "description": "The product name of the asset."
        },
        "product_version": {
          "type": "string",
          "description": "The version of the product identifying the asset."
        },
        "product_vendor": {
          "type": "string",
          "description": "The vendor of the product identified by the asset (e.g. Intel)."
        },
        "kill_chain_phases": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "kill_chain_name": {
                "type": "string",
                "description": "The name of the kill chain."
              },
              "phase_name": {
                "type": "string",
                "description": "The name of the phase in the kill chain."
              }
            },
            "required": [
              "kill_chain_name",
              "phase_name"
            ]
          },
          "minItems": 1
        },
        "x_organization": {
          "type": "string",
          "description": "Reference to the organization which is owner of the information contained in the object.",
          "pattern": "^x-organization--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
        },
        "created_by_ref": {
          "pattern": "^[a-z0-9][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$",
          "description": "The ID of the Source object that describes who created this object."
        },
        "created": {
          "type": "string",
          "description": "Created date of the object",
          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
        },
        "modified": {
          "type": "string",
          "description": "Created date of the object",
          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
        },
        "revoked": {
          "type": "boolean",
          "description": "The revoked property indicates whether the object has been revoked."
        }
      }
    }
  ],
  "required": [
    "name",
    "description",
    "labels",
    "kill_chain_phases"
  ]
}
