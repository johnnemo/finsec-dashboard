{
  "id": "../sdos/x-vulnerability-score.json",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "x-vulnerability",
  "description": "A vulnerability level calculation based on well known protocols like CVSS.",
  "type": "object",
  "allOf": [
    {
      "$ref": "../../../stix2-schemas/schemas/common/core.json"
    },
    {
      "properties": {
        "type": {
          "type": "string",
          "description": "It MUST be the literal `x-vulnerability-score`.",
          "enum": [
            "x-vulnerability-score"
          ]
        },
        "id": {
          "title": "id",
          "pattern": "^x-vulnerability-score--"
        },
        "name": {
          "type": "string",
          "description": "The name of the vulnerability score entry."
        },
        "description": {
          "type": "string",
          "description": "A description that provides more details and context about the caclculated score."
        },
        "subtype": {
          "type": "string",
          "description": "The protocol of the vulnerability score calculation. This field should be one of vulnerability-score-ov."
        },
        "domain": {
          "type": "string",
          "description": "Specifies the domain of the vulnerability. It can be Cyber or Physical.",
          "enum": [
            "Cyber",
            "Physical"
          ]
        },
        "details": {
          "type": "object",
          "properties": {
            "AV": {
              "type": "string",
              "description": "The attack vector is the context by which it is possible to exploit the vulnerability. It can be N (network) A (adjacent), L (local) or P (physical).",
              "enum": [
                "N",
                "A",
                "L",
                "P"
              ]
            },
            "AC": {
              "type": "string",
              "description": "Attack complexity describes the conditions beyond the attacker's control that must exist in order to exploit the vulnerability. It can be L (low) or H (high).",
              "enum": [
                "L",
                "H"
              ]
            },
            "PR": {
              "type": "string",
              "description": "Privileges required to exploit the vulnerability. It can be N (none), L (low) or H (high).",
              "enum": [
                "N",
                "L",
                "H"
              ]
            },
            "UI": {
              "type": "string",
              "description": "User interaction needed to exploit the vulnerability. It can be N (none) or R (required).",
              "enum": [
                "N",
                "R"
              ]
            },
            "S": {
              "type": "string",
              "description": "The scope is the ability for a vulnerability in one software component to impact resources beyond its means, or privileges. It can be C (changed) or U (unchanged).",
              "enum": [
                "C",
                "U"
              ]
            },
            "C": {
              "type": "string",
              "description": "Impact to information confidentiality. It can be N (none), L (low) or H (high).",
              "enum": [
                "N",
                "L",
                "H"
              ]
            },
            "I": {
              "type": "string",
              "description": "Impact on integrity. It can be N (none), L (low) or H (high).",
              "enum": [
                "N",
                "L",
                "H"
              ]
            },
            "A": {
              "type": "string",
              "description": "Impact on availability. It can be N (none), L (low) or H (high).",
              "enum": [
                "N",
                "L",
                "H"
              ]
            },
            "E": {
              "type": "string",
              "description": "Exploit code maturity of the vulnerability. It can be X (not defined), U (unproven), P (proof-of-concept), F (functional) or H (high).",
              "enum": [
                "X",
                "U",
                "P",
                "F",
                "H"
              ]
            },
            "RL": {
              "type": "string",
              "description": "The remediation level of the vulnerability. It can be X (not defined), O (official fix), T (temporary fix), W (workaround), U (unavailable).",
              "enum": [
                "X",
                "O",
                "T",
                "W",
                "U"
              ]
            },
            "RC": {
              "type": "string",
              "description": "The report confidence is the degree of confidence in the existence of the vulnerability. It can be U (unknown), R (reasonable) or C (confirmed).",
              "enum": [
                "U",
                "R",
                "C"
              ]
            },
            "CR": {
              "type": "string",
              "description": "The confidentiality requirement allows to customize the vulnerability score according to the importance of the asset in terms of confidentiality. It can be X (not defined), L (low), M (medium) or H (high).",
              "enum": [
                "X",
                "L",
                "M",
                "H"
              ]
            },
            "IR": {
              "type": "string",
              "description": "The integrity requirement  allows to customize the vulnerability score according to the importance of the asset in terms of integrity. It can be X (not defined), L (low), M (medium) or H (high).",
              "enum": [
                "X",
                "L",
                "M",
                "H"
              ]
            },
            "AR": {
              "type": "string",
              "description": "The availability requirement allows to customize the vulnerability score according to the importance of the asset in terms of availability. It can be X (not defined), L (low), M (medium) or H (high).",
              "enum": [
                "X",
                "L",
                "M",
                "H"
              ]
            },
            "MAV": {
              "type": "string",
              "description": "The modified attack vector of the vulnerability. It can be X (not defined), N (network), A (adjacent network), L (logical) or P (physical).",
              "enum": [
                "X",
                "N",
                "A",
                "L",
                "P"
              ]
            },
            "MAC": {
              "type": "string",
              "description": "Modified attack complexity of the vulnerability. It can be X (not defined), L (low) or H (high).",
              "enum": [
                "X",
                "L",
                "H"
              ]
            },
            "MPR": {
              "type": "string",
              "description": "Modified privileges required of the vulnerability. It can be X (not defined), N (none), L (low), H (high).",
              "enum": [
                "X",
                "N",
                "L",
                "H"
              ]
            },
            "MUI": {
              "type": "string",
              "description": "Modified user interaction of the vulnerability. It can be X (not defined), N (none) or R (required).",
              "enum": [
                "X",
                "N",
                "R"
              ]
            },
            "MS": {
              "type": "string",
              "description": "Modified scope of the vulnerability. It can be X (not defined), C (changed) or U (unchanged).",
              "enum": [
                "X",
                "C",
                "U"
              ]
            },
            "MC": {
              "type": "string",
              "description": "Modified confidentiality of the vulnerability. It can be X (not defined), N (none), L (low) or H (high).",
              "enum": [
                "X",
                "N",
                "L",
                "H"
              ]
            },
            "MI": {
              "type": "string",
              "description": "Modified impact of the vulnerability. It can be X (not defined), N (none), L (low) or H (high).",
              "enum": [
                "X",
                "N",
                "L",
                "H"
              ]
            },
            "MA": {
              "type": "string",
              "description": "Modified availability of the vulnerability. It can be X (not defined), N (none), L (low) or H (high).",
              "enum": [
                "X",
                "N",
                "L",
                "H"
              ]
            },
			"exploitability_score": {
			  "type": "number",
			  "description": "Exploitability score.",
			  "min": 0,
			  "max": 10
			},
			"impact_score": {
			  "type": "number",
			  "description": "Impact score.",
			  "min": 0,
			  "max": 10
			},
            "base_score": {
              "type": "number",
              "description": "Vulnerability base score.",
              "min": 0,
              "max": 10
            },
            "temporal_score": {
              "type": "number",
              "description": "Vulnerability temporal score.",
              "min": 0,
              "max": 10
            },
            "environmental_score": {
              "type": "number",
              "description": "Vulnerability environmental score",
              "min": 0,
              "max": 10
            }
          },
          "required": [
            "AV",
            "AC",
            "PR",
            "UI",
            "S",
            "C",
            "I",
            "A",
			"exploitability_score",
			"impact_score",
			"base_score"
          ]
        },
        "vuln_severity": {
          "type": "number",
          "description": "Vulnerability Base score",
          "min": 0,
          "max": 10
        },
        "x_organization": {
          "type": "string",
          "description": "Reference to the organization which is owner of the information contained in the object.",
          "pattern": "^x-organization--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
        },
        "datatype": {
          "type": "string",
          "description": "Datatype can be Model or Instance. Model indicates that the object is a model that can be used as a basis for the analytics. Instance is used when the object is generated at run-time.",
          "enum": [
            "Model",
            "Instance"
          ]
        },
        "reference": {
          "type": "string",
          "description": "It refers to the vulnerability evaluated by the vulnerability score.",
          "pattern": "^vulnerability--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
        },
        "model_ref": {
          "type": "string",
          "description": "Is used by the vulnerability score with datatype Instance to refer to the related model.",
          "pattern": "^x-[a-z0-9][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
        }
      }
    }
  ],
  "required": [
    "subtype",
	"domain",
    "x_organization",
    "details",
    "datatype",
    "reference",
    "model_ref"
  ],
  "vulnerability-score-ov": {
    "type": "string",
    "enum": [
      "CVSS_v3"
    ]
  }
}
