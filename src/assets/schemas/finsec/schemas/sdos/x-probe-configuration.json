{
  "id": "../sdos/x-probe-configuration.json",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "x-probe-configuration",
  "description": "Identifies a probe configuration.",
  "type": "object",
  "allOf": [
    {
      "$ref": "../../../stix2-schemas/schemas/common/core.json"
    },
    {
      "properties": {
        "type": {
          "type": "string",
          "description": "It MUST be the literal `x-probe-configuration`.",
          "enum": [
            "x-probe-configuration"
          ]
        },
        "subtype": {
          "type": "string",
          "description": "Subtype defines the probe storing approach.",
          "enum": [
            "LOG"
          ]
        },
		"domain": {
		  "type": "string",
		  "description": "The domain the asset belongs to. It can be Cyber, Physical or Hybrid.",
		  "enum": [
		    "Cyber",
			"Physical",
			"Hybrid"
		  ]
		},
        "id": {
          "title": "id",
          "pattern": "^x-probe-configuration--"
        },
        "name": {
          "type": "string",
          "description": "The name of the probe configuration."
        },
        "description": {
          "type": "string",
          "description": "A short description for the probe configuration."
        },
        "x_organization": {
          "type": "string",
		  "description": "Reference to the organization which is owner of the information contained in the object.",
          "pattern": "^x-organization--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
        },
        "monitoring_rate": {
          "type": "integer",
          "description": "The maximum number of packects the probe under configuration should apply."
        },
        "artifact_configuration": {
          "type": "object",
          "description": "The binary configuration to instantly configure the probe.",
          "$ref": "../../../stix2-schemas/schemas/observables/artifact.json"
        },
        "area_refs": {
          "type": "array",
          "description": "Specifies the STIX areas of interest monitored with this configuration.",
          "items": {
            "pattern": "^x-area--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
          },
          "minItems": 1
        },
        "event_refs": {
          "type": "array",
          "description": "Contains the references to the events (of datatype model) that can be generated by the probe with this configuration.",
          "items": {
            "pattern": "^x-event--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
          },
          "minItems": 1
        },
        "datatype": {
          "type": "string",
          "description": "Datatype can be Model or Instance. Model indicates that the object is a model that can be used as a basis for the analytics. Instance is used when the object is generated at run-time.",
          "enum": [
            "Model",
            "Instance"
          ]
        },
        "reference": {
          "type": "string",
		  "description": "Reference to the probe cunfigured by the probe configuration.",
          "pattern": "^x-probe--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
        },
        "model_ref": {
          "type": "string",
          "description": "Is used by the probe configuration with datatype instance to refer to the related model.",
          "pattern": "^x-[a-z0-9][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
        }
      }
    }
  ],
  "required": [
    "monitoring_rate",
    "probe_observable_type",
    "datatype",
    "reference",
    "model_ref",
    "x_organization",
	"subtype",
	"name",
	"description",
	"artifact_configuration",
	"area_refs",
	"event_refs",
	"domain"
  ]
}
